# ğŸ›ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©: Cognitive Agent System

## ğŸ¯ Ø§Ù„Ø±Ø¤ÙŠØ©

ØªØ­ÙˆÙŠÙ„ AI Kernel Ù…Ù† **Ø£Ø¯Ø§Ø© Ø§ØªØµØ§Ù„ Ø¨Ø³ÙŠØ·Ø©** Ø¥Ù„Ù‰ **Ù†Ø¸Ø§Ù… ÙˆÙƒÙŠÙ„ Ù…Ø¹Ø±ÙÙŠ Ù…ØªÙƒØ§Ù…Ù„** ÙŠÙ…ÙƒÙ†Ù‡:
1. ÙÙ‡Ù… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©
2. ØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ Ø¥Ù„Ù‰ Ø£ÙˆØ¬Ù‡ (Facets)
3. ØªÙ†Ø³ÙŠÙ‚ Ù†Ù…Ø§Ø°Ø¬ Ù…ØªØ¹Ø¯Ø¯Ø©
4. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
5. Ø¥Ù†ØªØ§Ø¬ Ø±Ø¤Ù‰ Ù‚ÙŠÙ‘Ù…Ø©

---

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Frontend Layer                          â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Chat Mode      â”‚       â”‚   Agent Mode     â”‚            â”‚
â”‚  â”‚ (Direct Kernel)  â”‚       â”‚ (Via Agent)      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                       â”‚
              â”‚                       â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                       â”‚
      â”‚ Direct                          Agent â”‚
      â”‚ Access                          Accessâ”‚
      â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent Orchestrator                        â”‚
â”‚                    (NEW - Intelligence Layer)                â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚Task Manager  â”‚ Facet System â”‚  Prompt      â”‚            â”‚
â”‚  â”‚              â”‚              â”‚  Builder     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Analyzer    â”‚ Pattern      â”‚  Report      â”‚            â”‚
â”‚  â”‚              â”‚ Detector     â”‚  Generator   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚        Kernel Client (Bridge)             â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI Kernel                               â”‚
â”‚                 (EXISTING - Infrastructure)                  â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Router     â”‚   Contract   â”‚   Memory     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Logger     â”‚ Error Handlerâ”‚ Health Check â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Adapter Layer                             â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ OpenAI   â”‚  Gemini  â”‚ DeepSeek â”‚ Copilot  â”‚             â”‚
â”‚  â”‚ Adapter  â”‚  Adapter â”‚  Adapter â”‚  Adapter â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ Layer 1 Hard Constraint (Non-Negotiable)

> [!CAUTION]
> **Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… = Layer 1 ÙÙ‚Ø· (Measurement Layer)**
> 
> **Ù…Ù…Ù†ÙˆØ¹ Ù…Ù†Ø¹Ø§Ù‹ Ø¨Ø§ØªØ§Ù‹:**
> ```
> âŒ Analyzer ÙŠÙØ­Ù„Ù„ â†’ Ù„Ø§ ÙŠÙÙØ³Ø±
> âŒ Pattern Detector ÙŠÙƒØªØ´Ù â†’ Ù„Ø§ ÙŠÙÙ‚ÙŠÙ‘Ù…
> âŒ Gap Finder ÙŠÙØ³Ø¬Ù„ â†’ Ù„Ø§ ÙŠÙÙˆØµÙŠ
> âŒ Report Generator ÙŠÙÙˆØ«Ù‚ â†’ Ù„Ø§ ÙŠØ­ÙƒÙ…
> ```
> 
> **Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø­Ø§Ø³Ù…:**
> ```javascript
> // âœ… Layer 1 (Ù…Ø³Ù…ÙˆØ­)
> {
>   pattern: "SQL Injection",
>   found_by: ["openai", "gemini", "deepseek"],
>   frequency: 3/3
> }
> 
> // âŒ Layer 1 (Ù…Ù…Ù†ÙˆØ¹!)
> {
>   issue: "SQL Injection",
>   severity: "critical",           â† ØªÙ‚ÙŠÙŠÙ… Ù…Ù…Ù†ÙˆØ¹
>   recommendation: "Use prepared statements"  â† ØªÙˆØµÙŠØ© Ù…Ù…Ù†ÙˆØ¹Ø©
> }
> ```
> 
> **Layer 2 (Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„)** Ø³ÙŠÙØ¹Ù„ Ø§Ù„ØªÙØ³ÙŠØ± ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª.  
> **Layer 1 (Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹)** ÙŠÙÙ‚ÙŠØ³ ÙÙ‚Ø·.
> 
> **Ø§Ù„Ù…Ø±Ø¬Ø¹:** [`SYSTEM_CONTRACT.md`](../../docs/SYSTEM_CONTRACT.md) - Source of Truth

---

## ğŸ“¦ Ù…ÙƒÙˆÙ†Ø§Øª Agent Layer Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©

### **1. Agent Orchestrator** (Ø§Ù„Ù‚Ø§Ø¦Ø¯)

**Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
```javascript
class AgentOrchestrator {
  async executeTask(taskConfig, input) {
    // 1. Initialize
    // 2. Execute Round 1
    // 3. Analyze
    // 4. Execute Round 2 (if needed)
    // 5. Generate Report
  }
}
```

**Ø§Ù„Ø®ØµØ§Ø¦Øµ:**
- âœ… ÙŠÙ†Ø³Ù‘Ù‚ Ø¨ÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
- âœ… ÙŠØ¯ÙŠØ± ØªØ¯ÙÙ‚ Ø§Ù„Ø¹Ù…Ù„ (Workflow)
- âœ… ÙŠØªØ®Ø° Ù‚Ø±Ø§Ø±Ø§Øª (Ù…ØªÙ‰ Round 2ØŸ Ø£ÙŠ ModelsØŸ)

---

### **2. Task Manager** (Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ù…)

**Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
```javascript
class TaskManager {
  registerTask(task) { }
  getTask(taskId) { }
  validateTask(task) { }
}
```

**Tasks Ø§Ù„Ù…Ø®Ø·Ø· Ù„Ù‡Ø§:**
- `js-code-audit` - Ù…Ø±Ø§Ø¬Ø¹Ø© ÙƒÙˆØ¯ JavaScript
- `api-design-review` - Ù…Ø±Ø§Ø¬Ø¹Ø© ØªØµÙ…ÙŠÙ… API
- `security-scan` - ÙØ­Øµ Ø£Ù…Ù†ÙŠ
- `performance-analysis` - ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡

**Ø§Ù„Ø¨Ù†ÙŠØ©:**
```javascript
{
  id: 'js-code-audit',
  name: 'JavaScript Security Audit',
  facets: ['security', 'performance', 'quality'],
  models: ['openai', 'gemini', 'deepseek'],
  rounds: 2,
  promptBuilder: Function,
  analyzer: Function
}
```

---

### **3. Facet System** (Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙˆØ¬Ù‡)

**Ø§Ù„ÙÙƒØ±Ø©:**
ÙƒÙ„ Ù…Ù‡Ù…Ø© Ù„Ù‡Ø§ **Ø£ÙˆØ¬Ù‡ Ù…ØªØ¹Ø¯Ø¯Ø©** (Security, Performance, Quality, etc.)

**Ø§Ù„Ù…Ø«Ø§Ù„:**
```javascript
// Code Audit Task
facets = [
  {
    id: 'security',
    name: 'Security Issues',
    systemPrompt: 'You are a security auditor. Find ONLY security vulnerabilities.',
    constraints: [
      'List issues only, no explanations',
      'Use this format: Issue: ... | Location: ... | Severity: ...'
    ],
    examples: [...]
  },
  {
    id: 'performance',
    name: 'Performance Problems',
    systemPrompt: 'You are a performance expert. Find ONLY performance issues.',
    constraints: [...]
  }
]
```

**Ø§Ù„ÙÙˆØ§Ø¦Ø¯:**
- âœ… Domain Lock ÙˆØ§Ø¶Ø­
- âœ… Ù‚Ø§Ø¨Ù„ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- âœ… Ø³Ù‡Ù„ Ø§Ù„ØªÙˆØ³Ø¹

---

### **4. Prompt Builder** (Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£ÙˆØ§Ù…Ø±)

**Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
```javascript
class PromptBuilder {
  buildRound1Prompt(facet, input) {
    return {
      system: facet.systemPrompt,
      user: `${facet.constraints.join('\n')}\n\nCode:\n${input}`,
      examples: facet.examples
    };
  }
  
  buildRound2Prompt(facet, round1Results, gaps) {
    return {
      system: facet.systemPrompt,
user: `Previous analysis found: ${round1Results}
        
        Gaps identified: ${gaps.join('\n')}
        
        Focus on these specific areas...`
    };
  }
}
```

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
- âœ… Domain Lock enforcement
- âœ… Few-shot examples
- âœ… Context injection

---

### **5. Analyzer** (Ø§Ù„Ù…Ø­Ù„Ù„)

**Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
```javascript
class ResponseAnalyzer {
  analyze(responses) {
    return {
      patterns: this.detectPatterns(responses),
      gaps: this.findGaps(responses),
      contradictions: this.checkContradictions(responses),
      confidence: this.calculateConfidence(responses)
    };
  }
  
  detectPatterns(responses) {
    // Find common issues across models
  }
  
  findGaps(responses) {
    // Find what one model mentioned but others missed
  }
  
  checkContradictions(responses) {
    // Find conflicting statements
  }
}
```

**Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª:**
- Pattern Detection: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù‚ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©
- Gap Analysis: Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ØªØºØ·ÙŠØ©
- Contradiction Checking: ÙƒØ´Ù Ø§Ù„ØªÙ†Ø§Ù‚Ø¶Ø§Øª
- Confidence Scoring: Ø­Ø³Ø§Ø¨ Ø§Ù„Ø«Ù‚Ø©

---

### **6. Report Generator** (Ù…ÙˆÙ„Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø®Ø§Ù…)

> [!IMPORTANT]
> **Layer 1 Report = Raw Measurements ÙÙ‚Ø·**
> 
> Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:
> - âŒ Recommendations
> - âŒ Severity judgments
> - âŒ Executive decisions
> 
> ÙŠØ­ØªÙˆÙŠ ÙÙ‚Ø· Ø¹Ù„Ù‰:
> - âœ… Structured measurements
> - âœ… What each model said
> - âœ… Pattern frequencies
> - âœ… Gap annotations

**Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
```javascript
class ReportGenerator {
  generateRawReport(round1, round2, analysis) {
    return {
      // Ù‚ÙŠØ§Ø³Ø§Øª ÙÙ‚Ø· - Ù„Ø§ Ø£Ø­ÙƒØ§Ù…
      measurements: {
        byFacet: this.groupByFacet(round1, round2),
        patterns: analysis.patterns,      // ØªÙƒØ±Ø§Ø±Ø§Øª ÙÙ‚Ø·
        gaps: analysis.gaps,              // Ù…Ø§ ÙØ§Øª ÙƒÙ„ Ù†Ù…ÙˆØ°Ø¬
        contradictions: analysis.contradictions
      },
      
      // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ø¸Ù…Ø© - Ù„Ø§ ØªÙØ³ÙŠØ±
      raw_findings: this.extractFindings(round1, round2),
      
      // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - Ù„Ø§ ØªÙ‚ÙŠÙŠÙ…
      stats: {
        total_findings: Number,
        pattern_frequency: Object,
        model_coverage: Object
      },
      
      markdown: this.toMarkdown()  // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø·
    };
  }
}
```

**Ù‚Ø§Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø®Ø§Ù… (Raw Report):**
```markdown
# Raw Measurement Report: Security Analysis

## Data Collection Summary
- Models Queried: 3 (OpenAI, Gemini, DeepSeek)
- Facets Analyzed: Security
- Rounds Completed: 2

## Pattern Measurements (Frequency Count)

### Security Facet
**Pattern: "SQL Injection"**
- Mentioned by: OpenAI âœ“, Gemini âœ“, DeepSeek âœ“
- Frequency: 3/3 models
- Location mentioned: Line 45 (by all)
- **Note:** High agreement = strong pattern

**Pattern: "XSS Vulnerability"**  
- Mentioned by: Gemini âœ“, DeepSeek âœ“
- Frequency: 2/3 models
- Location: Line 78
- **Gap:** OpenAI did not mention this

### Performance Facet
...

## Cross-Model Measurements
- **Common Patterns:** SQL Injection (3/3), XSS (2/3)
- **Unique Findings:** 
  - OpenAI only: "Race condition on line 92"
  - Gemini only: "Memory leak potential"
- **Contradictions:** None detected

## Data Summary
- Total patterns identified: 5
- Models in full agreement: 1 pattern
- Gaps requiring Round 2: 3
```

---

## ğŸ”„ Data Flow Ø§Ù„ÙƒØ§Ù…Ù„

### **Scenario: Code Audit**

```
1. User Input
   â†“
   User: "Audit this JavaScript code"
   Code: <paste code>
   
2. Frontend â†’ Agent Mode
   â†“
   POST /api/agent/execute
   {
     taskType: 'js-code-audit',
     input: <code>
   }

3. Agent Orchestrator
   â†“
   - Load task: js-code-audit
   - Facets: [security, performance, quality]
   - Models: [openai, gemini, deepseek]

4. Round 1 (Parallel)
   â†“
   For each facet:
     For each model:
       - Build constrained prompt
       - Send via Kernel
       - Collect response
   
   Results:
   {
     security: {
       openai: [...],
       gemini: [...],
       deepseek: [...]
     },
     performance: {...},
     quality: {...}
   }

5. Analysis
   â†“
   - Patterns: [SQL Injection, XSS] (all 3 agree)
   - Gaps: {
       openai: [missed CSRF],
       gemini: [missed rate limiting]
     }
   - Contradictions: None

6. Round 2 (Targeted)
   â†“
   For each gap:
     - Build focused prompt
     - Ask specific model
     - Get deeper insight

7. Report Generation
   â†“
   - Combine Round 1 + Round 2
   - Apply templates
   - Calculate confidence
   
8. Response to User
   â†“
   {
     status: 'complete',
     report: <markdown>,
     findings: {...},
     confidence: 0.87
   }

9. UI Display
   â†“
   - Show in panels:
     Panel 1: OpenAI findings
     Panel 2: Gemini findings
     Panel 3: DeepSeek findings
     Panel 4: Combined report
```

---

## ğŸ—‚ï¸ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agent/                    â† NEW
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator.js
â”‚   â”‚   â”‚   â”œâ”€â”€ kernel-client.js
â”‚   â”‚   â”‚   â””â”€â”€ state-manager.js
â”‚   â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”‚   â”œâ”€â”€ task-registry.js
â”‚   â”‚   â”‚   â”œâ”€â”€ base-task.js
â”‚   â”‚   â”‚   â””â”€â”€ implementations/
â”‚   â”‚   â”‚       â”œâ”€â”€ js-code-audit.task.js
â”‚   â”‚   â”‚       â””â”€â”€ api-design-review.task.js
â”‚   â”‚   â”œâ”€â”€facets/
â”‚   â”‚   â”‚   â”œâ”€â”€ facet-library.js
â”‚   â”‚   â”‚   â””â”€â”€ definitions/
â”‚   â”‚   â”‚       â”œâ”€â”€ security.facet.js
â”‚   â”‚   â”‚       â”œâ”€â”€ performance.facet.js
â”‚   â”‚   â”‚       â””â”€â”€ quality.facet.js
â”‚   â”‚   â”œâ”€â”€ prompts/
â”‚   â”‚   â”‚   â”œâ”€â”€ prompt-builder.js
â”‚   â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚   â”œâ”€â”€ analyzer/
â”‚   â”‚   â”‚   â”œâ”€â”€ response-analyzer.js
â”‚   â”‚   â”‚   â”œâ”€â”€ pattern-detector.js
â”‚   â”‚   â”‚   â”œâ”€â”€ gap-finder.js
â”‚   â”‚   â”‚   â””â”€â”€ contradiction-checker.js
â”‚   â”‚   â”œâ”€â”€ reports/
â”‚   â”‚   â”‚   â”œâ”€â”€ report-generator.js
â”‚   â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚   â”‚       â””â”€â”€ audit-report.template.md
â”‚   â”‚   â”œâ”€â”€ contracts/
â”‚   â”‚   â”‚   â”œâ”€â”€ agent-task.contract.js
â”‚   â”‚   â”‚   â””â”€â”€ agent-response.contract.js
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â”œâ”€â”€ orchestrator.test.js
â”‚   â”‚       â””â”€â”€ analyzer.test.js
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ chat.controller.js     â† EXISTING
â”‚   â”‚   â””â”€â”€ agent.controller.js     â† NEW
â”‚   â””â”€â”€ core/                       â† EXISTING (no changes)
â”‚       â”œâ”€â”€ contract.js
â”‚       â”œâ”€â”€ router.js
â”‚       â””â”€â”€ ...
```

---

## ğŸ”Œ API Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©

### **Agent Endpoints:**

```javascript
// Execute Agent Task
POST /api/agent/execute
{
  taskType: 'js-code-audit',
  input: '<code>',
  options: {
    models: ['openai', 'gemini'],  // optional
    facets: ['security', 'performance'],  // optional
    rounds: 2  // optional
  }
}

Response:
{
  taskId: 'task-123',
  status: 'complete',
  report: {...},
  runtime: '45s'
}

// Get Task Status
GET /api/agent/tasks/:taskId

// List Available Tasks
GET /api/agent/tasks

// Get Task History
GET /api/agent/history
```

---

## ğŸ“Š Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ÙŠÙ†

### **Chat Mode (Ø§Ù„Ø­Ø§Ù„ÙŠ):**
```
Request â†’ Kernel â†’ Model â†’ Response
```
- âš¡ Ø³Ø±ÙŠØ¹ (Ø«ÙˆØ§Ù†Ù)
- ğŸ¯ Ù…Ø¨Ø§Ø´Ø±
- ğŸ’¬ Ù…Ø­Ø§Ø¯Ø«Ø© Ø­Ø±Ø©

### **Agent Mode (Ø§Ù„Ø¬Ø¯ÙŠØ¯):**
```
Request â†’ Agent â†’ Task â†’ Facets â†’ Models (via Kernel) 
        â†’ Analysis â†’ Report
```
- ğŸ§  Ø°ÙƒÙŠ (Ø¯Ù‚Ø§Ø¦Ù‚)
- ğŸ“Š ØªØ­Ù„ÙŠÙ„ÙŠ
- ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ù…Ù†Ø¸Ù…

---

## âœ… Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„ØªØµÙ…ÙŠÙ…

### **1. Separation of Concerns**
```
Agent = Intelligence
Kernel = Infrastructure
```

### **2. Single Responsibility**
ÙƒÙ„ component Ù„Ù‡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© ÙˆØ§Ø­Ø¯Ø© ÙˆØ§Ø¶Ø­Ø©

### **3. Open/Closed Principle**
- Open for extension (Ø¥Ø¶Ø§ÙØ© Tasks/Facets Ø¬Ø¯ÙŠØ¯Ø©)
- Closed for modification (Ù„Ø§ Ù†ØºÙŠØ± Kernel)

### **4. Dependency Inversion**
```
Agent â†’ Interface â†’ Kernel
(Ù„Ø§ ÙŠØ¹ØªÙ…Ø¯ Agent Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Kernel implementation)
```

---

## ğŸ¯ Ø§Ù„Ø®Ù„Ø§ØµØ©

Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© ØªØ­Ù‚Ù‚:
- âœ… **Orchestration:** ØªÙ†Ø³ÙŠÙ‚ Ø°ÙƒÙŠ
- âœ… **Domain Lock:** Ù‚ÙŠÙˆØ¯ ØµØ§Ø±Ù…Ø©
- âœ… **Analysis:** ØªØ­Ù„ÙŠÙ„ Ø¹Ù…ÙŠÙ‚
- âœ… **Multi-Round:** Ø¬ÙˆÙ„Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
- âœ… **Reports:** ØªÙ‚Ø§Ø±ÙŠØ± Ù‚ÙŠØ§Ø³ÙŠØ©
- âœ… **Extensibility:** Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªÙˆØ³Ø¹
- âœ… **Maintainability:** Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©

ÙƒÙ„ Ù‡Ø°Ø§ **Ø¨Ø¯ÙˆÙ† Ø§Ù„Ù…Ø³Ø§Ø³ Ø¨Ù€ Kernel Ø§Ù„Ø­Ø§Ù„ÙŠ**! ğŸ‰

---

**Ø§Ù„Ø³Ø§Ø¨Ù‚:** [â† 01-current-state.md](./01-current-state.md)  
**Ø§Ù„ØªØ§Ù„ÙŠ:** [03-phase-0-preparation.md â†’](./03-phase-0-preparation.md)
